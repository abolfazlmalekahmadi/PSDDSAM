Please see the 'final' branch.
